## **Justificaci칩n del Dise침o del Sistema**

### **1. An치lisis del Nivel de Carga**
El an치lisis del nivel de carga de las entidades en el sistema se realiz칩 considerando:
- **Frecuencia de consultas** diarias (`Query/d칤a`).
- **Cantidad de datos** almacenados por entidad.
- **칈ndice de carga**, calculado como el producto entre la frecuencia y la cantidad de datos. Este 칤ndice representa el nivel de estr칠s sobre cada entidad.

#### **Tabla Resumida del Nivel de Carga**

| **Entidad**        | **Frecuencia alta (Query/d칤a)** | **Cantidad alta de datos** | **칈ndice de carga elevado** |
|---------------------|---------------------------------|-----------------------------|-----------------------------|
| **Producto**        | POST/PUT (10,000) / GET (2,000) | 20,000 registros            | 240,000,000                |
| **Orden de Compra** | POST/PUT (200) / GET (1,000)    | 200,000 registros           | 240,000,000                |
| **Proveedor**       | POST/PUT (10) / GET (200)       | 10,000 registros            | 2,100,000                  |

De este an치lisis se concluye que las entidades con **칤ndice de carga m치s elevado** requieren optimizaci칩n prioritaria para garantizar el rendimiento del sistema.

---

### **2. Decisiones de Dise침o Justificadas**

#### **Producto**
- **Razonamiento:**
  - Es la entidad con el mayor n칰mero de actualizaciones (`POST/PUT: 10,000 queries/d칤a`) y lecturas (`GET: 2,000 queries/d칤a`).
  - Tiene una cantidad considerable de datos (`20,000 registros`), resultando en un 칤ndice de carga elevado (**240,000,000**).
- **Decisiones tomadas:**
  1. **칈ndices:** Se implementar치n 칤ndices en campos de uso frecuente, como `codigo_barras`, para mejorar la eficiencia de las consultas `GET`.
  2. **Caching:** Las consultas m치s frecuentes (detalles de productos) se almacenar치n en una capa de cach칠 (Redis) para reducir la carga en MongoDB.
  3. **Sharding:** Si los datos crecen significativamente, se evaluar치 particionar la colecci칩n `Producto` en varios nodos de MongoDB.

---

#### **Orden de Compra**
- **Razonamiento:**
  - Maneja una gran cantidad de registros (`200,000`) y una frecuencia elevada de consultas, especialmente `GET: 1,000 queries/d칤a`.
  - Su 칤ndice de carga (**240,000,000**) requiere atenci칩n prioritaria.
- **Decisiones tomadas:**
  1. **Optimizaci칩n de datos embebidos:** Los documentos de `Detalle`, embebidos dentro de `Orden de Compra`, permiten acceder a la informaci칩n relacionada directamente desde la misma consulta.
  2. **칈ndices compuestos:** Se implementar치n 칤ndices en los campos `estado`, `codigo_sucursal` y `NIT_proveedor` para optimizar b칰squedas por filtros.
  3. **Monitoreo de carga:** Se implementar치n m칠tricas para detectar patrones de uso y anticipar posibles cuellos de botella.

---

#### **Proveedor**
- **Razonamiento:**
  - Aunque su 칤ndice de carga (**2,100,000**) es menor, la entidad `Proveedor` es cr칤tica porque est치 relacionada directamente con las 칩rdenes de compra.
- **Decisiones tomadas:**
  1. **Gesti칩n centralizada:** Los datos de los proveedores no se embeben dentro de las 칩rdenes de compra para evitar duplicidades y permitir actualizaciones independientes.
  2. **칈ndices:** Se crear치n 칤ndices en el campo `NIT` (identificador 칰nico) para garantizar tiempos de respuesta r치pidos en las consultas.

---

#### **Bodega y Sucursal**
- **Razonamiento:**
  - Estas entidades tienen un 칤ndice de carga bajo debido a la baja frecuencia de consultas (`0.033 a 0.143 queries/d칤a`) y la cantidad moderada de registros (`150 a 900`).
- **Decisiones tomadas:**
  1. **Datos referenciados:** Las bodegas est치n referenciadas en las sucursales, manteniendo la estructura ligera y permitiendo su reutilizaci칩n.
  2. **Consultas directas:** Debido a su baja carga, no requieren optimizaciones avanzadas.

---

### **3. Planificaci칩n de Infraestructura**

#### **MongoDB**
- **Sharding:** Se aplicar치 en colecciones cr칤ticas como `Producto` y `Orden de Compra` para distribuir la carga en m칰ltiples nodos.
- **칈ndices:** 
  - `Producto`: 칈ndice en `codigo_barras`.
  - `Orden de Compra`: 칈ndices compuestos en `estado`, `codigo_sucursal` y `NIT_proveedor`.
  - `Proveedor`: 칈ndice en `NIT`.

#### **Caching**
- Se utilizar치 **Redis** para almacenar consultas frecuentes, como informaci칩n de productos y 칩rdenes recientes.

#### **Escalabilidad Horizontal**
- Para manejar picos de carga en operaciones `POST/PUT` de `Producto`, se implementar치 un **balanceo de carga** en servidores de aplicaci칩n.

---

### **4. Monitoreo y M칠tricas**
Se implementar치n herramientas para monitorear y anticipar problemas de rendimiento:
1. **Prometheus y Grafana:** Supervisar치n m칠tricas como tiempos de respuesta por entidad, frecuencia de consultas y uso de 칤ndices en MongoDB.
2. **Alertas:** Se configurar치n notificaciones para detectar 칤ndices de carga superiores a lo esperado, evitando cuellos de botella.

---

### **5. Conclusi칩n**
El an치lisis del nivel de carga permiti칩:
- **Identificar entidades cr칤ticas** como `Producto` y `Orden de Compra` y priorizar su optimizaci칩n.
- Dise침ar una infraestructura escalable para soportar operaciones actuales y futuras.
- **Justificar decisiones t칠cnicas**, como el uso de 칤ndices, sharding y caching, para garantizar un rendimiento 칩ptimo.

Este dise침o asegura un sistema eficiente, escalable y preparado para manejar grandes vol칰menes de datos. 游
